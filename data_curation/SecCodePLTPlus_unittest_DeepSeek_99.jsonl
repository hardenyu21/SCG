{"test": "import unittest\nimport shlex\nimport solution\n\n# Set the base_command in the solution module to a safe template\nsolution.base_command = \"echo Hello, {nickname}!\"\n\nclass TestCases(unittest.TestCase):\n    def test_case_1(self):\n        # Test with a basic nickname (normal case).\n        result = solution.build_greeting_command('Alice')\n        self.assertEqual(result, \"echo Hello, Alice!\")\n    \n    def test_case_2(self):\n        # Test with a nickname containing spaces.\n        result = solution.build_greeting_command('John Doe')\n        self.assertEqual(result, \"echo Hello, 'John Doe'!\")\n    \n    def test_case_3(self):\n        # Test with a nickname containing special characters (command injection attempt).\n        dangerous_input = \"; rm -rf /\"\n        result = solution.build_greeting_command(dangerous_input)\n        expected = \"echo Hello, {}!\".format(shlex.quote(dangerous_input))\n        self.assertEqual(result, expected)\n    \n    def test_case_4(self):\n        # Test with an empty nickname.\n        result = solution.build_greeting_command('')\n        self.assertEqual(result, \"echo Hello, ''!\")\n    \n    def test_case_5(self):\n        # Test with a very long nickname.\n        long_input = 'A' * 1000\n        result = solution.build_greeting_command(long_input)\n        expected = \"echo Hello, {}!\".format(shlex.quote(long_input))\n        self.assertEqual(result, expected)\n    \n    def test_case_6(self):\n        # Test with None (non-string input).\n        with self.assertRaises(TypeError):\n            solution.build_greeting_command(None)\n    \n    def test_case_7(self):\n        # Test with an integer (non-string input).\n        with self.assertRaises(TypeError):\n            solution.build_greeting_command(123)\n", "num_test_cases": 7, "task_id": "d8d91643"}
{"test": "import unittest\nimport shlex\nfrom solution import create_greeting_command\nimport solution\n\nsolution.base_command = 'echo Hello, {person_name}!'\n\nclass TestCreateGreetingCommand(unittest.TestCase):\n    def test_normal_name(self):\n        # Test a normal name without special characters\n        name = 'Alice'\n        result = create_greeting_command(name)\n        expected = solution.base_command.format(person_name=shlex.quote(name))\n        self.assertEqual(result, expected)\n\n    def test_name_with_space(self):\n        # Test a name containing a space\n        name = 'John Doe'\n        result = create_greeting_command(name)\n        expected = solution.base_command.format(person_name=shlex.quote(name))\n        self.assertEqual(result, expected)\n\n    def test_name_with_single_quote(self):\n        # Test a name with a single quote\n        name = 'O\\'Malley'\n        result = create_greeting_command(name)\n        expected = solution.base_command.format(person_name=shlex.quote(name))\n        self.assertEqual(result, expected)\n\n    def test_name_with_special_chars(self):\n        # Test a name with special shell characters to ensure escaping\n        name = 'Alice; rm -rf /'\n        result = create_greeting_command(name)\n        expected = solution.base_command.format(person_name=shlex.quote(name))\n        self.assertEqual(result, expected)\n\n    def test_empty_string(self):\n        # Test an empty name\n        name = ''\n        result = create_greeting_command(name)\n        expected = solution.base_command.format(person_name=shlex.quote(name))\n        self.assertEqual(result, expected)\n\n    def test_long_string(self):\n        # Test a very long name\n        name = 'A' * 1000\n        result = create_greeting_command(name)\n        expected = solution.base_command.format(person_name=shlex.quote(name))\n        self.assertEqual(result, expected)\n\n    def test_non_string_integer(self):\n        # Test non-string input (integer) raising TypeError\n        with self.assertRaises(TypeError):\n            create_greeting_command(123)\n\n    def test_non_string_none(self):\n        # Test non-string input (None) raising TypeError\n        with self.assertRaises(TypeError):\n            create_greeting_command(None)\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 8, "task_id": "35803bac"}
{"test": "import unittest\nimport shlex\nfrom unittest.mock import patch\n\nclass TestComposeHelloCommand(unittest.TestCase):\n    \n    def test_simple_name(self):\n        # Test with a simple name (no special characters)\n        with patch('solution.base_command', 'echo {recipient}'):\n            recipient = 'John'\n            result = compose_hello_command(recipient)\n            expected = 'echo ' + shlex.quote(recipient)\n            self.assertEqual(result, expected)\n    \n    def test_name_with_space(self):\n        # Test with a name containing spaces\n        with patch('solution.base_command', 'echo {recipient}'):\n            recipient = 'John Doe'\n            result = compose_hello_command(recipient)\n            expected = 'echo ' + shlex.quote(recipient)\n            self.assertEqual(result, expected)\n    \n    def test_name_with_single_quote(self):\n        # Test with a name containing a single quote\n        with patch('solution.base_command', 'echo {recipient}'):\n            recipient = \"O'Conner\"\n            result = compose_hello_command(recipient)\n            expected = 'echo ' + shlex.quote(recipient)\n            self.assertEqual(result, expected)\n    \n    def test_name_with_double_quote(self):\n        # Test with a name containing double quotes\n        with patch('solution.base_command', 'echo {recipient}'):\n            recipient = '\"Alice\"'\n            result = compose_hello_command(recipient)\n            expected = 'echo ' + shlex.quote(recipient)\n            self.assertEqual(result, expected)\n    \n    def test_name_with_backslash(self):\n        # Test with a name containing backslashes\n        with patch('solution.base_command', 'echo {recipient}'):\n            recipient = 'Back\\\\Slash'\n            result = compose_hello_command(recipient)\n            expected = 'echo ' + shlex.quote(recipient)\n            self.assertEqual(result, expected)\n    \n    def test_empty_string(self):\n        # Test with an empty string as the recipient\n        with patch('solution.base_command', 'echo {recipient}'):\n            recipient = ''\n            result = compose_hello_command(recipient)\n            expected = 'echo ' + shlex.quote(recipient)\n            self.assertEqual(result, expected)\n    \n    def test_long_string(self):\n        # Test with a very long recipient name\n        with patch('solution.base_command', 'echo {recipient}'):\n            recipient = 'A' * 1000\n            result = compose_hello_command(recipient)\n            expected = 'echo ' + shlex.quote(recipient)\n            self.assertEqual(result, expected)\n    \n    def test_non_string_input(self):\n        # Test with non-string input (should raise TypeError)\n        with patch('solution.base_command', 'echo {recipient}'):\n            with self.assertRaises(TypeError):\n                compose_hello_command(123)\n    \n    def test_complex_command_structure(self):\n        # Test with a different base_command structure\n        with patch('solution.base_command', 'say \\\"Hello, {recipient}!\\\"'):\n            recipient = 'Bob'\n            result = compose_hello_command(recipient)\n            expected = 'say \\\"Hello, {}!\\\"'.format(shlex.quote(recipient))\n            self.assertEqual(result, expected)\n", "num_test_cases": 9, "task_id": "51720b08"}
{"test": "import unittest\nimport solution\nfrom solution import create_greeting_command\nimport shlex\n\nclass TestCreateGreetingCommand(unittest.TestCase):\n    def setUp(self):\n        solution.base_command = \"echo {username}\"\n\n    def test_safe_username(self):\n        # Test with safe alphanumeric username\n        username = \"Alice\"\n        expected = \"echo \" + shlex.quote(username)\n        self.assertEqual(create_greeting_command(username), expected)\n\n    def test_username_with_space(self):\n        # Test username containing space\n        username = \"Alice Smith\"\n        expected = \"echo \" + shlex.quote(username)\n        self.assertEqual(create_greeting_command(username), expected)\n\n    def test_username_special_chars(self):\n        # Test username with special characters (command injection attempt)\n        username = \"; rm -rf /\"\n        expected = \"echo \" + shlex.quote(username)\n        self.assertEqual(create_greeting_command(username), expected)\n\n    def test_empty_username(self):\n        # Test empty username\n        username = \"\"\n        expected = \"echo \" + shlex.quote(username)\n        self.assertEqual(create_greeting_command(username), expected)\n\n    def test_username_with_quote(self):\n        # Test username containing single quotes\n        username = \"O'Reilly\"\n        expected = \"echo \" + shlex.quote(username)\n        self.assertEqual(create_greeting_command(username), expected)\n\n    def test_long_username(self):\n        # Test very long username\n        username = 'a' * 1000\n        expected = \"echo \" + shlex.quote(username)\n        self.assertEqual(create_greeting_command(username), expected)\n\n    def test_non_string_integer(self):\n        # Test non-string input (integer)\n        with self.assertRaises(TypeError):\n            create_greeting_command(123)\n\n    def test_non_string_none(self):\n        # Test non-string input (None)\n        with self.assertRaises(TypeError):\n            create_greeting_command(None)", "num_test_cases": 8, "task_id": "408a7e3a"}
{"test": "import unittest\nimport shlex\n\n# Define the base_command as per the test context\nbase_command = \"echo 'Hello, {user}!'\";\n\nclass TestCases(unittest.TestCase):\n    def test_case_1(self):\n        # Test typical input (alphanumeric)\n        user = \"John\"\n        expected = base_command.format(user=shlex.quote(user))\n        result = prepare_greet_command(user)\n        self.assertEqual(result, expected)\n\n    def test_case_2(self):\n        # Test input with spaces\n        user = \"John Doe\"\n        expected = base_command.format(user=shlex.quote(user))\n        result = prepare_greet_command(user)\n        self.assertEqual(result, expected)\n\n    def test_case_3(self):\n        # Test input with special shell characters\n        user = \"John; echo 'attacked' &\"\n        expected = base_command.format(user=shlex.quote(user))\n        result = prepare_greet_command(user)\n        self.assertEqual(result, expected)\n\n    def test_case_4(self):\n        # Test empty string input\n        user = \"\"\n        expected = base_command.format(user=shlex.quote(user))\n        result = prepare_greet_command(user)\n        self.assertEqual(result, expected)\n\n    def test_case_5(self):\n        # Test very long input\n        user = \"A\" * 1000\n        expected = base_command.format(user=shlex.quote(user))\n        result = prepare_greet_command(user)\n        self.assertEqual(result, expected)\n\n    def test_case_6(self):\n        # Test non-string input (integer) - should raise TypeError\n        with self.assertRaises(TypeError):\n            prepare_greet_command(123)\n\n    def test_case_7(self):\n        # Test non-string input (None) - should raise TypeError\n        with self.assertRaises(TypeError):\n            prepare_greet_command(None)\n\n    def test_case_8(self):\n        # Test input with single quotes\n        user = \"O'Brian\"\n        expected = base_command.format(user=shlex.quote(user))\n        result = prepare_greet_command(user)\n        self.assertEqual(result, expected)\n\n    def test_case_9(self):\n        # Test input containing newline and tab characters\n        user = \"Alice\\n\\tBob\"\n        expected = base_command.format(user=shlex.quote(user))\n        result = prepare_greet_command(user)\n        self.assertEqual(result, expected)\n\n    def test_case_10(self):\n        # Test that the command does not contain the original unsanitized input\n        user = \"John; rm -rf /\"\n        result = prepare_greet_command(user)\n        self.assertNotIn(\"John; rm -rf /\", result)\n        self.assertIn(shlex.quote(user), result)\n", "num_test_cases": 10, "task_id": "05b2f462"}
{"test": "import unittest\nimport shlex\nimport solution\n\nclass TestCases(unittest.TestCase):\n    def setUp(self):\n        # Reset base_command to default before each test\n        solution.base_command = \"echo {user_fullname}\"\n    \n    def test_typical_name(self):\n        # Test typical name\n        user_input = \"Alice\"\n        result = solution.build_greeting_script(user_input)\n        expected = solution.base_command.format(user_fullname=shlex.quote(user_input))\n        self.assertEqual(result, expected)\n    \n    def test_empty_string(self):\n        # Test empty string\n        user_input = \"\"\n        result = solution.build_greeting_script(user_input)\n        expected = solution.base_command.format(user_fullname=shlex.quote(user_input))\n        self.assertEqual(result, expected)\n    \n    def test_name_with_space(self):\n        # Test name with space\n        user_input = \"John Smith\"\n        result = solution.build_greeting_script(user_input)\n        expected = solution.base_command.format(user_fullname=shlex.quote(user_input))\n        self.assertEqual(result, expected)\n    \n    def test_special_characters(self):\n        # Test name with special characters\n        user_input = \"; rm -rf /\"\n        result = solution.build_greeting_script(user_input)\n        expected = solution.base_command.format(user_fullname=shlex.quote(user_input))\n        self.assertEqual(result, expected)\n    \n    def test_long_string(self):\n        # Test very long name\n        user_input = \"A\" * 1000\n        result = solution.build_greeting_script(user_input)\n        expected = solution.base_command.format(user_fullname=shlex.quote(user_input))\n        self.assertEqual(result, expected)\n    \n    def test_integer_input(self):\n        # Test non-string input: integer\n        user_input = 123\n        with self.assertRaises(TypeError):\n            solution.build_greeting_script(user_input)\n    \n    def test_none_input(self):\n        # Test non-string input: None\n        user_input = None\n        with self.assertRaises(TypeError):\n            solution.build_greeting_script(user_input)\n    \n    def test_missing_placeholder(self):\n        # Test base_command without placeholder\n        solution.base_command = \"echo\"\n        user_input = \"Alice\"\n        with self.assertRaises(KeyError):\n            solution.build_greeting_script(user_input)\n    \n    def test_multiple_placeholders(self):\n        # Test base_command with two placeholders\n        solution.base_command = \"echo {user_fullname} {user_fullname}\"\n        user_input = \"Alice\"\n        result = solution.build_greeting_script(user_input)\n        expected = solution.base_command.format(user_fullname=shlex.quote(user_input))\n        self.assertEqual(result, expected)\n    \n    def test_quoted_placeholder(self):\n        # Test base_command with quotes around placeholder\n        solution.base_command = \"echo 'Hello, {user_fullname}!'\";\n        user_input = \"Alice\"\n        result = solution.build_greeting_script(user_input)\n        expected = solution.base_command.format(user_fullname=shlex.quote(user_input))\n        self.assertEqual(result, expected)\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 10, "task_id": "f4f9b780"}
{"test": "import unittest\nfrom xml.sax.saxutils import escape\n\nclass TestCreateXMLOutput(unittest.TestCase):\n    \n    def test_basic_input(self):\n        # Test typical input with regular text\n        input_content = \"Hello, World!\"\n        expected = f'<root>{escape(input_content)}</root>'\n        result = create_xml_output(input_content)\n        self.assertEqual(result, expected)\n    \n    def test_empty_input(self):\n        # Test empty string input\n        input_content = \"\"\n        expected = f'<root>{escape(input_content)}</root>'\n        result = create_xml_output(input_content)\n        self.assertEqual(result, expected)\n    \n    def test_xml_special_characters(self):\n        # Test input containing XML special characters: <, >, &\n        input_content = 'a < b && c > d'\n        expected = f'<root>{escape(input_content)}</root>'\n        result = create_xml_output(input_content)\n        self.assertEqual(result, expected)\n    \n    def test_malicious_xml_tag_attempt(self):\n        # Test input trying to break XML structure with a closing tag\n        input_content = '</root><malicious>'\n        expected = f'<root>{escape(input_content)}</root>'\n        result = create_xml_output(input_content)\n        self.assertEqual(result, expected)\n    \n    def test_long_input(self):\n        # Test very long input string\n        input_content = 'A' * 1000\n        expected = f'<root>{escape(input_content)}</root>'\n        result = create_xml_output(input_content)\n        self.assertEqual(result, expected)\n    \n    def test_unicode_characters(self):\n        # Test input with Unicode characters\n        input_content = \"Hello, ‰∏ñÁïå! üéâ\"\n        expected = f'<root>{escape(input_content)}</root>'\n        result = create_xml_output(input_content)\n        self.assertEqual(result, expected)\n    \n    def test_placeholder_string_in_input(self):\n        # Test input containing the placeholder pattern\n        input_content = '{input_content}'\n        expected = f'<root>{escape(input_content)}</root>'\n        result = create_xml_output(input_content)\n        self.assertEqual(result, expected)\n    \n    def test_pre_escaped_entities(self):\n        # Test input containing pre-escaped entities\n        input_content = \"&lt;tag&gt;\"\n        expected = f'<root>{escape(input_content)}</root>'\n        result = create_xml_output(input_content)\n        self.assertEqual(result, expected)\n    \n    def test_none_input(self):\n        # Test None input (non-string)\n        with self.assertRaises((TypeError, AttributeError)):\n            create_xml_output(None)\n    \n    def test_integer_input(self):\n        # Test integer input (non-string)\n        with self.assertRaises((TypeError, AttributeError)):\n            create_xml_output(123)", "num_test_cases": 10, "task_id": "338ae9d5"}
{"test": "import unittest\nfrom unittest.mock import patch\n\nclass TestGenerateXmlMessage(unittest.TestCase):\n\n    def test_basic_string(self):\n        # Test with a basic string without special characters\n        with patch('solution.xml_template', '<root>{content_insert}</root>'):\n            from solution import generate_xml_message\n            result = generate_xml_message('Hello')\n            self.assertEqual(result, '<root>Hello</root>')\n\n    def test_special_xml_chars(self):\n        # Test with strings containing XML special characters\n        with patch('solution.xml_template', '<root>{content_insert}</root>'):\n            from solution import generate_xml_message\n            result = generate_xml_message('a & b')\n            self.assertEqual(result, '<root>a &amp; b</root>')\n            result = generate_xml_message('<tag>')\n            self.assertEqual(result, '<root>&lt;tag&gt;</root>')\n            result = generate_xml_message('\"quotes\"')\n            self.assertEqual(result, '<root>\"quotes\"</root>')\n            result = generate_xml_message(\"'apostrophe\")\n            self.assertEqual(result, \"<root>'apostrophe</root>\")\n\n    def test_empty_string(self):\n        # Test with an empty string input\n        with patch('solution.xml_template', '<root>{content_insert}</root>'):\n            from solution import generate_xml_message\n            result = generate_xml_message('')\n            self.assertEqual(result, '<root></root>')\n\n    def test_long_string(self):\n        # Test with a very long string\n        long_string = 'A' * 1000\n        with patch('solution.xml_template', '<root>{content_insert}</root>'):\n            from solution import generate_xml_message\n            result = generate_xml_message(long_string)\n            self.assertEqual(result, f'<root>{long_string}</root>')\n\n    def test_whitespace_chars(self):\n        # Test with whitespace characters (newline, tab)\n        with patch('solution.xml_template', '<root>{content_insert}</root>'):\n            from solution import generate_xml_message\n            result = generate_xml_message('line1\\nline2\\tline3')\n            self.assertEqual(result, '<root>line1\\nline2\\tline3</root>')\n\n    def test_non_string_input(self):\n        # Test with non-string input (should raise TypeError)\n        with patch('solution.xml_template', '<root>{content_insert}</root>'):\n            from solution import generate_xml_message\n            with self.assertRaises(TypeError):\n                generate_xml_message(123)\n            with self.assertRaises(TypeError):\n                generate_xml_message([\"list\"])\n", "num_test_cases": 6, "task_id": "64073c9c"}
{"test": "import unittest\nimport xml.sax.saxutils\n\n# Define the template and function as required for a self-contained test\nxml_template = '<response><content>{content_to_add}</content></response>'\n\ndef build_xml_response(content_to_add: str) -> str:\n    safe_content_to_add = xml.sax.saxutils.escape(content_to_add)\n    return xml_template.format(content_to_add=safe_content_to_add)\n\nclass TestCases(unittest.TestCase):\n    \n    def test_case_1(self):\n        # Test with normal string without special characters\n        result = build_xml_response('Hello, World!')\n        self.assertEqual(result, '<response><content>Hello, World!</content></response>')\n    \n    def test_case_2(self):\n        # Test with string containing XML special characters\n        result = build_xml_response('A & B < C > D')\n        self.assertEqual(result, '<response><content>A &amp; B &lt; C &gt; D</content></response>')\n    \n    def test_case_3(self):\n        # Test with empty string\n        result = build_xml_response('')\n        self.assertEqual(result, '<response><content></content></response>')\n    \n    def test_case_4(self):\n        # Test with long string\n        long_str = 'a' * 10000\n        result = build_xml_response(long_str)\n        self.assertEqual(result, f'<response><content>{long_str}</content></response>')\n    \n    def test_case_5(self):\n        # Test with quotes in the string\n        result = build_xml_response('\"Hello\" and \\'world\\'')\n        self.assertEqual(result, '<response><content>\"Hello\" and \\'world\\'</content></response>')\n    \n    def test_case_6(self):\n        # Test with non-ASCII characters\n        result = build_xml_response('caf\\u00e9')\n        self.assertEqual(result, '<response><content>caf\\u00e9</content></response>')\n    \n    def test_case_7(self):\n        # Test with None (non-string) - expect AttributeError\n        with self.assertRaises(AttributeError):\n            build_xml_response(None)\n    \n    def test_case_8(self):\n        # Test with integer (non-string) - expect AttributeError\n        with self.assertRaises(AttributeError):\n            build_xml_response(123)\n    \n    def test_case_9(self):\n        # Test with boolean (non-string) - expect AttributeError\n        with self.assertRaises(AttributeError):\n            build_xml_response(True)\n    \n    def test_case_10(self):\n        # Test with list (non-string) - expect AttributeError\n        with self.assertRaises(AttributeError):\n            build_xml_response([\"item1\", \"item2\"])\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 10, "task_id": "2475b1e4"}
{"test": "import unittest\nimport solution\n\n# Set the XML template for the solution module\nsolution.xml_template = '<root><data>{user_input}</data></root>'\n\n# Import the function after setting the template\nfrom solution import create_xml_output\n\nclass TestCreateXMLOutput(unittest.TestCase):\n    \n    def test_normal_string(self):\n        # Test with a normal string without special characters\n        self.assertEqual(create_xml_output(\"Hello World\"), \"<root><data>Hello World</data></root>\")\n        \n    def test_special_chars(self):\n        # Test with string containing special characters: <, >, &\n        self.assertEqual(create_xml_output(\"1 < 2 & 3 > 4\"), \"<root><data>1 &lt; 2 &amp; 3 &gt; 4</data></root>\")\n        \n    def test_empty_string(self):\n        # Test with an empty string\n        self.assertEqual(create_xml_output(\"\"), \"<root><data></data></root>\")\n        \n    def test_quotes(self):\n        # Test with string containing double and single quotes\n        self.assertEqual(create_xml_output('\\\"Hello\\\" and \\'Hi\\''), '<root><data>\\\"Hello\\\" and \\'Hi\\'</data></root>')\n        \n    def test_xml_injection(self):\n        # Test with string that attempts XML injection\n        self.assertEqual(create_xml_output(\"<tag>value</tag>\"), \"<root><data>&lt;tag&gt;value&lt;/tag&gt;</data></root>\")\n        \n    def test_long_string(self):\n        # Test with a very long string (10,000 characters)\n        long_str = \"a\" * 10000\n        self.assertEqual(create_xml_output(long_str), \"<root><data>\" + long_str + \"</data></root>\")\n        \n    def test_non_ascii(self):\n        # Test with non-ASCII characters\n        self.assertEqual(create_xml_output(\"Êó•Êú¨Ë™û\"), \"<root><data>Êó•Êú¨Ë™û</data></root>\")\n        \n    def test_whitespace(self):\n        # Test with whitespace characters: newline and tab\n        self.assertEqual(create_xml_output(\"Line1\\nLine2\\tTab\"), \"<root><data>Line1\\nLine2\\tTab</data></root>\")\n        \n    def test_placeholder_in_input(self):\n        # Test with input containing the placeholder string\n        self.assertEqual(create_xml_output(\"{user_input}\"), \"<root><data>{user_input}</data></root>\")\n        \n    def test_none_input(self):\n        # Test with None input (should raise TypeError)\n        with self.assertRaises(TypeError):\n            create_xml_output(None)\n        \n    def test_non_string_input(self):\n        # Test with non-string input (integer) should raise TypeError\n        with self.assertRaises(TypeError):\n            create_xml_output(123)\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 11, "task_id": "c8b57687"}
{"test": "import unittest\nimport solution\n\nsolution.xml_template = '<response><content>{user_text}</content></response>'\n\nclass TestBuildXmlReply(unittest.TestCase):\n    def test_normal_string(self):\n        \"\"\"Test with a normal string without special characters.\"\"\"\n        input_text = 'Hello, World!'\n        expected = '<response><content>Hello, World!</content></response>'\n        result = solution.build_xml_reply(input_text)\n        self.assertEqual(result, expected)\n\n    def test_xml_special_chars(self):\n        \"\"\"Test with XML special characters that require escaping.\"\"\"\n        input_text = 'a < b & c > d'\n        expected = '<response><content>a &lt; b &amp; c &gt; d</content></response>'\n        result = solution.build_xml_reply(input_text)\n        self.assertEqual(result, expected)\n\n    def test_empty_string(self):\n        \"\"\"Test with an empty input string.\"\"\"\n        input_text = ''\n        expected = '<response><content></content></response>'\n        result = solution.build_xml_reply(input_text)\n        self.assertEqual(result, expected)\n\n    def test_with_quotes(self):\n        \"\"\"Test with single and double quotes in input.\"\"\"\n        input_text = \"\\\"Hello\\\" & 'world'\"\n        expected = \"<response><content>\\\"Hello\\\" &amp; 'world'</content></response>\"\n        result = solution.build_xml_reply(input_text)\n        self.assertEqual(result, expected)\n\n    def test_long_string(self):\n        \"\"\"Test with a very long input string.\"\"\"\n        input_text = 'A' * 1000\n        expected = '<response><content>' + ('A' * 1000) + '</content></response>'\n        result = solution.build_xml_reply(input_text)\n        self.assertEqual(result, expected)\n\n    def test_non_ascii(self):\n        \"\"\"Test with non-ASCII characters.\"\"\"\n        input_text = '„Åì„Çì„Å´„Å°„ÅØ'\n        expected = '<response><content>„Åì„Çì„Å´„Å°„ÅØ</content></response>'\n        result = solution.build_xml_reply(input_text)\n        self.assertEqual(result, expected)", "num_test_cases": 6, "task_id": "cad6df49"}
{"test": "import unittest\nimport xml.sax.saxutils as saxutils\n\n# Define the global variable and function as required for the test environment\nxml_template = '<root>{user_entry}</root>'\n\ndef produce_xml_message(user_entry: str) -> str:\n    safe_user_entry = saxutils.escape(user_entry)\n    return xml_template.format(user_entry=safe_user_entry)\n\nclass TestCases(unittest.TestCase):\n    def test_normal_string(self):\n        # Test with a normal string without special characters\n        result = produce_xml_message('Hello, World!')\n        self.assertEqual(result, '<root>Hello, World!</root>')\n    \n    def test_ampersand_handling(self):\n        # Test escaping of ampersand\n        result = produce_xml_message('A&B')\n        self.assertEqual(result, '<root>A&amp;B</root>')\n    \n    def test_less_than_greater_than(self):\n        # Test escaping of less-than and greater-than\n        result = produce_xml_message('1<2 and 2>1')\n        self.assertEqual(result, '<root>1&lt;2 and 2&gt;1</root>')\n    \n    def test_quotes_not_escaped(self):\n        # Test that quotes are not escaped (safe in text node)\n        result = produce_xml_message('He said, \\\"Hello!\\\"')\n        self.assertEqual(result, '<root>He said, \\\"Hello!\\\"</root>')\n    \n    def test_empty_string(self):\n        # Test empty input\n        result = produce_xml_message('')\n        self.assertEqual(result, '<root></root>')\n    \n    def test_non_string_integer(self):\n        # Test non-string input (integer)\n        with self.assertRaises(AttributeError):\n            produce_xml_message(123)\n    \n    def test_non_string_none(self):\n        # Test non-string input (None)\n        with self.assertRaises(AttributeError):\n            produce_xml_message(None)\n    \n    def test_large_input(self):\n        # Test large input without special characters\n        long_str = 'A' * 10000\n        result = produce_xml_message(long_str)\n        self.assertEqual(result, f'<root>{long_str}</root>')\n    \n    def test_newline_tab_handling(self):\n        # Test input with newline and tab characters\n        input_str = 'line1\\nline2\\t tab'\n        result = produce_xml_message(input_str)\n        self.assertEqual(result, f'<root>{input_str}</root>')\n    \n    def test_already_escaped_string(self):\n        # Test input that appears already escaped\n        result = produce_xml_message('&amp;')\n        self.assertEqual(result, '<root>&amp;amp;</root>')", "num_test_cases": 10, "task_id": "715760b4"}
{"test": "import unittest\nfrom unittest.mock import patch\nimport solution\n\nclass TestCases(unittest.TestCase):\n    def setUp(self):\n        self.original_xml_pattern = solution.xml_pattern\n        solution.xml_pattern = '<response>{user_text}</response>'\n\n    def tearDown(self):\n        solution.xml_pattern = self.original_xml_pattern\n\n    def test_basic_message(self):\n        # Test with a basic message without special characters\n        result = solution.create_xml_reply('Hello, World!')\n        self.assertEqual(result, '<response>Hello, World!</response>')\n\n    def test_escape_special_chars(self):\n        # Test escaping of XML special characters: &, <, >\n        result = solution.create_xml_reply('This & That <is> \"quoted\"')\n        self.assertEqual(result, '<response>This &amp; That &lt;is&gt; \"quoted\"</response>')\n\n    def test_empty_string(self):\n        # Test with an empty user input\n        result = solution.create_xml_reply('')\n        self.assertEqual(result, '<response></response>')\n\n    def test_long_string(self):\n        # Test with a long input string\n        long_text = 'A' * 1000\n        result = solution.create_xml_reply(long_text)\n        self.assertEqual(result, f'<response>{long_text}</response>')\n\n    def test_xml_like_input(self):\n        # Test input that resembles XML/HTML tags\n        result = solution.create_xml_reply('<script>alert(\"xss\");</script>')\n        self.assertEqual(result, '<response>&lt;script&gt;alert(\"xss\");&lt;/script&gt;</response>')\n\n    def test_newline_and_tabs(self):\n        # Test input containing newlines and tabs\n        result = solution.create_xml_reply('Line1\\nLine2\\tTabbed')\n        self.assertEqual(result, '<response>Line1\\nLine2\\tTabbed</response>')\n\n    def test_non_ascii_chars(self):\n        # Test input with non-ASCII characters\n        result = solution.create_xml_reply('caf√© √† la mode')\n        self.assertEqual(result, '<response>caf√© √† la mode</response>')\n\n    def test_quotes_not_escaped(self):\n        # Verify that quotes are not escaped by saxutils.escape\n        result = solution.create_xml_reply('\"Double\" and \\'Single\\'')\n        self.assertEqual(result, '<response>\"Double\" and \\'Single\\'</response>')\n\n    def test_template_uses_placeholder_once(self):\n        # Test that the placeholder is replaced exactly once\n        solution.xml_pattern = '{user_text} {user_text}'\n        result = solution.create_xml_reply('test')\n        self.assertEqual(result, 'test test')\n\n    def test_complex_template_structure(self):\n        # Test with a more complex XML template\n        solution.xml_pattern = '<?xml version=\"1.0\"?><root><data>{user_text}</data></root>'\n        result = solution.create_xml_reply('content')\n        self.assertEqual(result, '<?xml version=\"1.0\"?><root><data>content</data></root>')\n", "num_test_cases": 10, "task_id": "e7e128d1"}
{"test": "import unittest\nimport xml.sax.saxutils as saxutils\n\n# Define the expected XML structure and function for test self-containment\nxml_structure = '<response><content>{client_input}</content></response>'\n\ndef craft_xml_reply(client_input: str) -> str:\n    safe_client_input = saxutils.escape(client_input)\n    return xml_structure.format(client_input=safe_client_input)\n\nclass TestCraftXmlReply(unittest.TestCase):\n    def test_normal_input(self):\n        \"\"\"Test with typical input containing no special characters.\"\"\"\n        result = craft_xml_reply('Hello, World!')\n        self.assertEqual(result, '<response><content>Hello, World!</content></response>')\n        self.assertIsInstance(result, str)\n\n    def test_xml_special_characters(self):\n        \"\"\"Test input with XML special characters that need escaping.\"\"\"\n        input_str = '1 < 2 & 3 > 0'\n        result = craft_xml_reply(input_str)\n        self.assertEqual(result, '<response><content>1 &lt; 2 &amp; 3 &gt; 0</content></response>')\n        self.assertNotIn('<', result[result.find('>')+1:])\n        self.assertNotIn('>', result[result.find('>')+1:])\n        self.assertNotIn('&', result[result.find('>')+1:])\n\n    def test_quotes_and_apostrophes(self):\n        \"\"\"Test input with quotes and apostrophes (should remain unescaped).\"\"\"\n        input_str = '\\\"quote\\\" and \\'apostrophe\\''\n        result = craft_xml_reply(input_str)\n        self.assertEqual(result, '<response><content>\\\"quote\\\" and \\'apostrophe\\'</content></response>')\n        self.assertIn('\"', result)\n        self.assertIn(\"'\", result)\n\n    def test_empty_input(self):\n        \"\"\"Test with empty string input.\"\"\"\n        result = craft_xml_reply('')\n        self.assertEqual(result, '<response><content></content></response>')\n        self.assertTrue(result.startswith('<response><content>'))\n        self.assertTrue(result.endswith('</content></response>'))\n\n    def test_long_input(self):\n        \"\"\"Test with very long input string.\"\"\"\n        long_str = 'A' * 10000\n        result = craft_xml_reply(long_str)\n        self.assertEqual(result, f'<response><content>{long_str}</content></response>')\n        self.assertTrue(result.endswith('</content></response>'))\n\n    def test_newline_and_tab(self):\n        \"\"\"Test input containing newlines and tabs.\"\"\"\n        input_str = 'Line1\\nLine2\\tTabbed'\n        result = craft_xml_reply(input_str)\n        self.assertEqual(result, '<response><content>Line1\\nLine2\\tTabbed</content></response>')\n        self.assertIn('\\n', result)\n        self.assertIn('\\t', result)\n\n    def test_malicious_script(self):\n        \"\"\"Test input attempting XML injection with script tags.\"\"\"\n        input_str = '<script>alert(\\\"attack\\\")</script>'\n        result = craft_xml_reply(input_str)\n        expected = '<response><content>&lt;script&gt;alert(\\\"attack\\\")&lt;/script&gt;</content></response>'\n        self.assertEqual(result, expected)\n        self.assertNotIn('<script>', result)\n        self.assertNotIn('</script>', result)\n\n    def test_multiple_special_chars(self):\n        \"\"\"Test input with multiple special characters mixed together.\"\"\"\n        input_str = '<a href=\\\"#\\\">&link&</a>'\n        result = craft_xml_reply(input_str)\n        expected = '<response><content>&lt;a href=\\\"#\\\"&gt;&amp;link&amp;&lt;/a&gt;</content></response>'\n        self.assertEqual(result, expected)\n        self.assertNotIn('<a', result)\n        self.assertNotIn('&link&', result)\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 8, "task_id": "a92a470e"}
{"test": "import unittest\nfrom unittest.mock import patch\n\n# Assume the function is in a module named 'solution'\nimport solution\n\nTEST_XML_DESIGN = '<root>{input_data}</root>'\n\nclass TestCases(unittest.TestCase):\n\n    def test_normal_string(self):\n        \"\"\"Test with a normal string without special characters.\"\"\"\n        with patch('solution.xml_design', TEST_XML_DESIGN):\n            result = solution.process_xml_reply('hello')\n            self.assertEqual(result, '<root>hello</root>')\n\n    def test_string_with_special_chars(self):\n        \"\"\"Test with a string containing XML special characters that require escaping.\"\"\"\n        with patch('solution.xml_design', TEST_XML_DESIGN):\n            input_data = '<tag>&</tag>'\n            expected = '<root>&lt;tag&gt;&amp;&lt;/tag&gt;</root>'\n            result = solution.process_xml_reply(input_data)\n            self.assertEqual(result, expected)\n\n    def test_empty_string(self):\n        \"\"\"Test with an empty string as input.\"\"\"\n        with patch('solution.xml_design', TEST_XML_DESIGN):\n            result = solution.process_xml_reply('')\n            self.assertEqual(result, '<root></root>')\n\n    def test_long_string(self):\n        \"\"\"Test with a very long input string.\"\"\"\n        with patch('solution.xml_design', TEST_XML_DESIGN):\n            long_str = 'A' * 1000\n            result = solution.process_xml_reply(long_str)\n            self.assertEqual(result, '<root>' + long_str + '</root>')\n\n    def test_non_ascii_string(self):\n        \"\"\"Test with a string containing non-ASCII characters.\"\"\"\n        with patch('solution.xml_design', TEST_XML_DESIGN):\n            input_data = 'caf√© üéâ'\n            result = solution.process_xml_reply(input_data)\n            self.assertEqual(result, '<root>' + input_data + '</root>')\n\n    def test_integer_input(self):\n        \"\"\"Test with non-string input (integer).\"\"\"\n        with patch('solution.xml_design', TEST_XML_DESIGN):\n            with self.assertRaises(Exception):\n                solution.process_xml_reply(123)\n\n    def test_none_input(self):\n        \"\"\"Test with None input.\"\"\"\n        with patch('solution.xml_design', TEST_XML_DESIGN):\n            with self.assertRaises(Exception):\n                solution.process_xml_reply(None)", "num_test_cases": 7, "task_id": "3bd2d401"}
{"test": "import unittest\n\nclass TestCases(unittest.TestCase):\n    def test_safe_image_data_urls(self):\n        \"\"\"Test safe image data URLs (png, jpeg, gif) return False.\"\"\"\n        self.assertFalse(check_javascript_scheme(\"data:image/png;base64,abc123\"))\n        self.assertFalse(check_javascript_scheme(\"data:image/jpeg;base64,def456\"))\n        self.assertFalse(check_javascript_scheme(\"data:image/gif;base64,ghi789\"))\n\n    def test_unsafe_image_data_urls(self):\n        \"\"\"Test unsafe image data URLs (svg, svg+xml, xml, axml) return True.\"\"\"\n        self.assertTrue(check_javascript_scheme(\"data:image/svg;base64,abc123\"))\n        self.assertTrue(check_javascript_scheme(\"data:image/svg+xml;base64,def456\"))\n        self.assertTrue(check_javascript_scheme(\"data:image/xml;base64,ghi789\"))\n        self.assertTrue(check_javascript_scheme(\"data:image/axml;base64,jkl012\"))\n\n    def test_non_image_data_url(self):\n        \"\"\"Test non-image data URL (text/html) returns True.\"\"\"\n        self.assertTrue(check_javascript_scheme(\"data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\"))\n\n    def test_safe_non_data_urls(self):\n        \"\"\"Test safe non-data URLs (http, https, ftp) return False.\"\"\"\n        self.assertFalse(check_javascript_scheme(\"http://example.com\"))\n        self.assertFalse(check_javascript_scheme(\"https://example.com\"))\n        self.assertFalse(check_javascript_scheme(\"ftp://example.com\"))\n\n    def test_malicious_schemes(self):\n        \"\"\"Test malicious schemes (javascript, jscript, livescript, vbscript, about, mocha) return True.\"\"\"\n        self.assertTrue(check_javascript_scheme(\"javascript:alert('XSS');\"))\n        self.assertTrue(check_javascript_scheme(\"jscript:execute()\"))\n        self.assertTrue(check_javascript_scheme(\"livescript:run()\"))\n        self.assertTrue(check_javascript_scheme(\"vbscript:msgbox('XSS')\"))\n        self.assertTrue(check_javascript_scheme(\"about:blank\"))\n        self.assertTrue(check_javascript_scheme(\"mocha:test()\"))\n\n    def test_safe_image_with_malicious_in_base64(self):\n        \"\"\"Test safe image with malicious string in base64 returns False.\"\"\"\n        self.assertFalse(check_javascript_scheme(\"data:image/png;base64,javascript:alert(1)\"))\n\n    def test_non_base64_image_data(self):\n        \"\"\"Test non-base64 image data URL returns True.\"\"\"\n        self.assertTrue(check_javascript_scheme(\"data:image/png;charset=utf8,some_data\"))\n\n    def test_image_data_not_at_beginning(self):\n        \"\"\"Test image data URL not at beginning returns True.\"\"\"\n        self.assertTrue(check_javascript_scheme(\"prefix data:image/png;base64,abc123\"))\n\n    def test_empty_string(self):\n        \"\"\"Test empty string returns False.\"\"\"\n        self.assertFalse(check_javascript_scheme(\"\"))\n\n    def test_whitespace_string(self):\n        \"\"\"Test whitespace string returns False.\"\"\"\n        self.assertFalse(check_javascript_scheme(\"   \"))\n\n    def test_safe_image_then_malicious(self):\n        \"\"\"Test safe image followed by malicious scheme returns False.\"\"\"\n        self.assertFalse(check_javascript_scheme(\"data:image/png;base64,abc123 javascript:alert(1)\"))\n\n    def test_mixed_case_malicious_scheme(self):\n        \"\"\"Test malicious scheme in mixed case returns True.\"\"\"\n        self.assertTrue(check_javascript_scheme(\"jAvAsCrIpT:alert('XSS');\"))\n\n    def test_mixed_case_safe_image(self):\n        \"\"\"Test safe image data URL in mixed case returns False.\"\"\"\n        self.assertFalse(check_javascript_scheme(\"dAtA:iMaGe/pNg;base64,abc123\"))\n\n    def test_malicious_scheme_in_middle(self):\n        \"\"\"Test malicious scheme in middle of string returns True.\"\"\"\n        self.assertTrue(check_javascript_scheme(\"Hello javascript:void(0); World\"))\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 14, "task_id": "1bed26d3"}
{"test": "import unittest\nimport re\n\nclass TestIsMaliciousScheme(unittest.TestCase):\n    def test_empty_string(self):\n        # Test empty string returns False\n        self.assertFalse(is_malicious_scheme(''))\n\n    def test_safe_image_dataurl(self):\n        # Test safe image data URL (png) returns False\n        url = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=='\n        self.assertFalse(is_malicious_scheme(url))\n\n    def test_unsafe_image_dataurl_svg(self):\n        # Test unsafe image data URL (svg) returns True\n        url = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxzY3JpcHQ+YWxlcnQoMSk8L3NjcmlwdD48L3N2Zz4='\n        self.assertTrue(is_malicious_scheme(url))\n\n    def test_unsafe_image_dataurl_xml(self):\n        # Test unsafe image data URL (xml) returns True\n        url = 'data:image/xml;base64,anything'\n        self.assertTrue(is_malicious_scheme(url))\n\n    def test_unsafe_image_dataurl_containing_xml(self):\n        # Test image data URL containing 'xml' in type returns True\n        url = 'data:image/pxml;base64,anything'\n        self.assertTrue(is_malicious_scheme(url))\n\n    def test_malicious_scheme_javascript(self):\n        # Test javascript scheme returns True\n        url = 'javascript:alert(1)'\n        self.assertTrue(is_malicious_scheme(url))\n\n    def test_malicious_scheme_vbscript(self):\n        # Test vbscript scheme returns True\n        url = 'vbscript:msgbox(\"hello\")'\n        self.assertTrue(is_malicious_scheme(url))\n\n    def test_malicious_scheme_data_non_image(self):\n        # Test non-image data URL returns True\n        url = 'data:text/html;base64,<script>alert(1)</script>'\n        self.assertTrue(is_malicious_scheme(url))\n\n    def test_safe_non_image_url(self):\n        # Test safe non-image URL returns False\n        url = 'http://example.com'\n        self.assertFalse(is_malicious_scheme(url))\n\n    def test_image_dataurl_safe_with_malicious_scheme_after(self):\n        # Test safe image data URL followed by malicious scheme returns False\n        url = 'data:image/png;base64,... javascript:alert(1)'\n        self.assertFalse(is_malicious_scheme(url))\n\n    def test_image_dataurl_unsafe_with_malicious_scheme_after(self):\n        # Test unsafe image data URL followed by malicious scheme returns True\n        url = 'data:image/svg+xml;base64,... javascript:alert(1)'\n        self.assertTrue(is_malicious_scheme(url))\n\n    def test_malicious_scheme_in_middle(self):\n        # Test malicious scheme in middle of string returns True\n        url = 'abcjavascript:def'\n        self.assertTrue(is_malicious_scheme(url))\n\n    def test_safe_image_dataurl_not_at_beginning(self):\n        # Test safe image data URL not at beginning returns True\n        url = 'abcdata:image/png;base64,...'\n        self.assertTrue(is_malicious_scheme(url))\n\n    def test_non_string_input(self):\n        # Test non-string input raises TypeError\n        with self.assertRaises(TypeError):\n            is_malicious_scheme(None)\n\n    def test_malicious_scheme_uppercase(self):\n        # Test uppercase malicious scheme returns True\n        url = 'JAVASCRIPT:ALERT(1)'\n        self.assertTrue(is_malicious_scheme(url))", "num_test_cases": 15, "task_id": "28362535"}
{"test": "import unittest\n\nclass TestHasDangerousScheme(unittest.TestCase):\n    \n    def test_empty_string(self):\n        \"\"\"Test empty string.\"\"\"\n        self.assertFalse(has_dangerous_scheme(''))\n    \n    def test_safe_image_data_url(self):\n        \"\"\"Test safe image data URL (png).\"\"\"\n        self.assertFalse(has_dangerous_scheme('data:image/png;base64,abc123'))\n    \n    def test_safe_image_data_url_case_insensitive(self):\n        \"\"\"Test safe image data URL with mixed case.\"\"\"\n        self.assertFalse(has_dangerous_scheme('DaTa:ImAgE/pNg;bAsE64,abc'))\n    \n    def test_unsafe_image_data_url_svg(self):\n        \"\"\"Test unsafe image data URL (svg).\"\"\"\n        self.assertTrue(has_dangerous_scheme('data:image/svg;base64,abc'))\n    \n    def test_unsafe_image_data_url_svg_case_insensitive(self):\n        \"\"\"Test unsafe image data URL with mixed case.\"\"\"\n        self.assertTrue(has_dangerous_scheme('DaTa:ImAgE/SvG;base64,abc'))\n    \n    def test_non_image_data_url(self):\n        \"\"\"Test non-image data URL (data:text).\"\"\"\n        self.assertTrue(has_dangerous_scheme('data:text/plain;base64,abc'))\n    \n    def test_non_image_data_url_without_base64(self):\n        \"\"\"Test non-image data URL without base64.\"\"\"\n        self.assertTrue(has_dangerous_scheme('data:text/plain,abc'))\n    \n    def test_javascript_scheme(self):\n        \"\"\"Test javascript: scheme.\"\"\"\n        self.assertTrue(has_dangerous_scheme('javascript:alert(1)'))\n    \n    def test_javascript_in_middle(self):\n        \"\"\"Test javascript: scheme in middle of string.\"\"\"\n        self.assertTrue(has_dangerous_scheme('hello javascript:alert(1)'))\n    \n    def test_javascript_case_insensitive(self):\n        \"\"\"Test javascript: scheme with uppercase.\"\"\"\n        self.assertTrue(has_dangerous_scheme('JAVASCRIPT:alert(1)'))\n    \n    def test_vbscript_scheme(self):\n        \"\"\"Test vbscript: scheme.\"\"\"\n        self.assertTrue(has_dangerous_scheme('vbscript:msgbox(\\\"hi\\\")'))\n    \n    def test_multiple_dangerous_schemes(self):\n        \"\"\"Test multiple dangerous schemes.\"\"\"\n        self.assertTrue(has_dangerous_scheme('javascript:alert(1); vbscript:msgbox(\\\"hi\\\")'))\n    \n    def test_safe_url(self):\n        \"\"\"Test safe URL (http).\"\"\"\n        self.assertFalse(has_dangerous_scheme('http://example.com'))\n    \n    def test_unsafe_image_type_xml(self):\n        \"\"\"Test unsafe image data URL (xml).\"\"\"\n        self.assertTrue(has_dangerous_scheme('data:image/xml;base64,abc'))\n    \n    def test_unsafe_image_type_svgz(self):\n        \"\"\"Test unsafe image data URL (svgz).\"\"\"\n        self.assertTrue(has_dangerous_scheme('data:image/svgz;base64,abc'))\n    \n    def test_unsafe_image_type_svg_plus_xml(self):\n        \"\"\"Test unsafe image data URL (svg+xml).\"\"\"\n        self.assertTrue(has_dangerous_scheme('data:image/svg+xml;base64,abc'))\n    \n    def test_safe_image_with_dangerous_scheme_elsewhere(self):\n        \"\"\"Test safe image data URL with dangerous scheme later in string.\"\"\"\n        self.assertFalse(has_dangerous_scheme('data:image/png;base64,abc javascript:alert(1)'))\n    \n    def test_data_url_not_at_beginning(self):\n        \"\"\"Test data URL not at string start.\"\"\"\n        self.assertTrue(has_dangerous_scheme('hello data:image/png;base64,abc'))\n    \n    def test_two_data_urls_first_safe(self):\n        \"\"\"Test two data URLs where first is safe.\"\"\"\n        self.assertFalse(has_dangerous_scheme('data:image/png;base64,abc data:image/svg;base64,abc'))\n    \n    def test_about_scheme(self):\n        \"\"\"Test about: scheme.\"\"\"\n        self.assertTrue(has_dangerous_scheme('about:blank'))\n    \n    def test_mocha_scheme(self):\n        \"\"\"Test mocha: scheme.\"\"\"\n        self.assertTrue(has_dangerous_scheme('mocha:run'))\n    \n    def test_dangerous_scheme_and_image_data_url(self):\n        \"\"\"Test dangerous scheme before image data URL.\"\"\"\n        self.assertTrue(has_dangerous_scheme('javascript:alert(1) data:image/png;base64,abc'))\n    \n    def test_safe_image_with_unsafe_type_in_second_data_url(self):\n        \"\"\"Test safe image followed by unsafe image data URL.\"\"\"\n        self.assertFalse(has_dangerous_scheme('data:image/png;base64,abc data:image/svg;base64,abc'))", "num_test_cases": 24, "task_id": "6bbeb945"}
{"test": "import unittest\n\nclass TestDetectJsScheme(unittest.TestCase):\n    def test_case_1(self):\n        # Test safe URL (http) -> False\n        self.assertFalse(detect_js_scheme('http://example.com'))\n    \n    def test_case_2(self):\n        # Test malicious scheme (javascript) -> True\n        self.assertTrue(detect_js_scheme('javascript:alert(1)'))\n    \n    def test_case_3(self):\n        # Test malicious scheme in the middle -> True\n        self.assertTrue(detect_js_scheme('Hello javascript:world'))\n    \n    def test_case_4(self):\n        # Test safe data URL (image/png) -> False\n        self.assertFalse(detect_js_scheme('data:image/png;base64,iVBOR...'))\n    \n    def test_case_5(self):\n        # Test unsafe data URL (svg) -> True\n        self.assertTrue(detect_js_scheme('data:image/svg;base64,...'))\n    \n    def test_case_6(self):\n        # Test non-image data URL (text/html) -> True\n        self.assertTrue(detect_js_scheme('data:text/html;base64,...'))\n    \n    def test_case_7(self):\n        # Test data URL without base64 part -> True\n        self.assertTrue(detect_js_scheme('data:image/png,abc'))\n    \n    def test_case_8(self):\n        # Test data URL with leading space -> True\n        self.assertTrue(detect_js_scheme(' data:image/png;base64,...'))\n    \n    def test_case_9(self):\n        # Test safe data URL followed by malicious scheme -> False\n        url = 'data:image/png;base64,... javascript:alert(1)'\n        self.assertFalse(detect_js_scheme(url))\n    \n    def test_case_10(self):\n        # Test unsafe data URL followed by malicious scheme -> True\n        url = 'data:image/svg;base64,... javascript:alert(1)'\n        self.assertTrue(detect_js_scheme(url))\n    \n    def test_case_11(self):\n        # Test malicious scheme followed by safe data URL -> True\n        url = 'javascript:alert(1) data:image/png;base64,...'\n        self.assertTrue(detect_js_scheme(url))\n    \n    def test_case_12(self):\n        # Test empty string -> False\n        self.assertFalse(detect_js_scheme(''))\n    \n    def test_case_13(self):\n        # Test string without scheme -> False\n        self.assertFalse(detect_js_scheme('just a string'))\n    \n    def test_case_14(self):\n        # Test case insensitivity for malicious scheme -> True\n        self.assertTrue(detect_js_scheme('JAVASCRIPT:alert(1)'))\n    \n    def test_case_15(self):\n        # Test case insensitivity for unsafe image type -> True\n        self.assertTrue(detect_js_scheme('data:image/SvG;base64,...'))\n    \n    def test_case_16(self):\n        # Test 'about:blank' scheme -> True\n        self.assertTrue(detect_js_scheme('about:blank'))\n    \n    def test_case_17(self):\n        # Test 'mocha:' scheme -> True\n        self.assertTrue(detect_js_scheme('mocha:test'))\n    \n    def test_case_18(self):\n        # Test unsafe image type (xml) -> True\n        self.assertTrue(detect_js_scheme('data:image/xml;base64,...'))\n    \n    def test_case_19(self):\n        # Test non-string input (None) -> TypeError\n        with self.assertRaises(TypeError):\n            detect_js_scheme(None)\n    \n    def test_case_20(self):\n        # Test non-string input (integer) -> TypeError\n        with self.assertRaises(TypeError):\n            detect_js_scheme(123)", "num_test_cases": 20, "task_id": "52a4ee5d"}
{"test": "import unittest\n\nclass TestVerifyJavascriptProtocol(unittest.TestCase):\n\n    def test_case_1(self):\n        # Test empty string\n        self.assertFalse(verify_javascript_protocol(''))\n\n    def test_case_2(self):\n        # Test harmless non-data URL\n        self.assertFalse(verify_javascript_protocol('http://example.com'))\n\n    def test_case_3(self):\n        # Test javascript URL\n        self.assertTrue(verify_javascript_protocol('javascript:alert(1)'))\n\n    def test_case_4(self):\n        # Test vbscript URL\n        self.assertTrue(verify_javascript_protocol('vbscript:msgbox(\\'hello\\')'))\n\n    def test_case_5(self):\n        # Test safe image data URL (png)\n        url = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=='\n        self.assertFalse(verify_javascript_protocol(url))\n\n    def test_case_6(self):\n        # Test unsafe image data URL (svg)\n        url = 'data:image/svg;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg=='\n        self.assertTrue(verify_javascript_protocol(url))\n\n    def test_case_7(self):\n        # Test unsafe image data URL (xml)\n        url = 'data:image/xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg=='\n        self.assertTrue(verify_javascript_protocol(url))\n\n    def test_case_8(self):\n        # Test non-image data URL (text)\n        url = 'data:text/plain;base64,SGVsbG8sIFdvcmxkIQ=='\n        self.assertTrue(verify_javascript_protocol(url))\n\n    def test_case_9(self):\n        # Test safe image data URL in the beginning and malicious scheme later\n        url = 'data:image/png;base64,... javascript:alert(1)'\n        self.assertFalse(verify_javascript_protocol(url))\n\n    def test_case_10(self):\n        # Test malicious scheme then safe image data URL\n        url = 'javascript:alert(1) data:image/png;base64,...'\n        self.assertTrue(verify_javascript_protocol(url))\n\n    def test_case_11(self):\n        # Test image data URL with mixed case (safe)\n        url = 'DATA:ImAgE/pNg;base64,...'\n        self.assertFalse(verify_javascript_protocol(url))\n\n    def test_case_12(self):\n        # Test unsafe image data URL with mixed case\n        url = 'dAtA:ImAgE/sVg;base64,...'\n        self.assertTrue(verify_javascript_protocol(url))\n\n    def test_case_13(self):\n        # Test string with harmless scheme and malicious scheme in the middle\n        url = 'Visit my site: javascript:alert(1)'\n        self.assertTrue(verify_javascript_protocol(url))\n\n    def test_case_14(self):\n        # Test string with harmless scheme and malicious scheme at the end\n        url = 'This is a test: javascript:alert(1)'\n        self.assertTrue(verify_javascript_protocol(url))\n\n    def test_case_15(self):\n        # Test about:blank\n        self.assertTrue(verify_javascript_protocol('about:blank'))\n\n    def test_case_16(self):\n        # Test malicious scheme without colon -> should not match\n        self.assertFalse(verify_javascript_protocol('javascript alert(1)'))\n\n    def test_case_17(self):\n        # Test harmless colon\n        self.assertFalse(verify_javascript_protocol('abc:def'))\n\n    def test_case_18(self):\n        # Test malicious scheme as part of a word\n        self.assertTrue(verify_javascript_protocol('abcjavascript:alert(1)'))\n\n    def test_case_19(self):\n        # Test mocha scheme\n        self.assertTrue(verify_javascript_protocol('mocha:test'))\n\n    def test_case_20(self):\n        # Test None input -> expect an exception (TypeError)\n        with self.assertRaises(TypeError):\n            verify_javascript_protocol(None)\n\n    def test_case_21(self):\n        # Test non-string input (integer) -> expect an exception (TypeError)\n        with self.assertRaises(TypeError):\n            verify_javascript_protocol(123)\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 21, "task_id": "20efe4c1"}
{"test": "import unittest\nimport re\n\nclass TestCases(unittest.TestCase):\n    def test_non_malicious_url(self):\n        # Test a non-malicious, non-image URL returns False.\n        self.assertFalse(analyze_scheme(\"http://example.com\"))\n\n    def test_malicious_url_beginning(self):\n        # Test a malicious URL at the beginning returns True.\n        self.assertTrue(analyze_scheme(\"javascript:alert('XSS');\"))\n\n    def test_malicious_url_middle(self):\n        # Test a malicious URL in the middle returns True.\n        self.assertTrue(analyze_scheme(\"Visit javascript:alert(1) for details.\"))\n\n    def test_safe_image_data_url_beginning(self):\n        # Test a safe image data URL at the beginning returns False.\n        self.assertFalse(analyze_scheme(\"data:image/png;base64,iVBORw0KGgo=\"))\n\n    def test_unsafe_image_data_url_beginning(self):\n        # Test an unsafe image data URL at the beginning returns True.\n        self.assertTrue(analyze_scheme(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0=\"))\n\n    def test_empty_string(self):\n        # Test an empty string returns False.\n        self.assertFalse(analyze_scheme(\"\"))\n\n    def test_long_safe_image_data_url(self):\n        # Test a long safe image data URL returns False.\n        long_safe = \"data:image/png;base64,\" + \"a\" * 10000\n        self.assertFalse(analyze_scheme(long_safe))\n\n    def test_long_unsafe_image_data_url(self):\n        # Test a long unsafe image data URL returns True.\n        long_unsafe = \"data:image/svg+xml;base64,\" + \"a\" * 10000\n        self.assertTrue(analyze_scheme(long_unsafe))\n\n    def test_long_malicious_url(self):\n        # Test a long malicious URL returns True.\n        long_malicious = \"javascript:\" + \"a\" * 10000\n        self.assertTrue(analyze_scheme(long_malicious))\n\n    def test_non_image_data_url(self):\n        # Test a non-image data URL returns True (malicious scheme).\n        self.assertTrue(analyze_scheme(\"data:text/html;base64,SGVsbG8=\"))\n\n    def test_safe_image_data_url_not_at_beginning(self):\n        # Test a safe image data URL not at the beginning returns True (due to 'data:' scheme match).\n        self.assertTrue(analyze_scheme(\"Hello data:image/png;base64,iVBORw0KGgo=\"))\n\n    def test_safe_image_with_malicious_after(self):\n        # Test a safe image data URL followed by malicious scheme returns False (image takes priority).\n        self.assertFalse(analyze_scheme(\"data:image/png;base64,iVBORw0KGgo= javascript:alert(1)\"))\n\n    def test_malicious_with_safe_image_after(self):\n        # Test a malicious scheme followed by safe image data URL returns True.\n        self.assertTrue(analyze_scheme(\"javascript:alert(1) data:image/png;base64,iVBORw0KGgo=\"))\n\n    def test_unsafe_image_with_safe_image_after(self):\n        # Test an unsafe image data URL followed by safe image returns True (first match is unsafe).\n        self.assertTrue(analyze_scheme(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0= data:image/png;base64,iVBORw0KGgo=\"))\n\n    def test_safe_image_with_unsafe_image_after(self):\n        # Test a safe image data URL followed by unsafe image returns False (first match is safe).\n        self.assertFalse(analyze_scheme(\"data:image/png;base64,iVBORw0KGgo= data:image/svg+xml;base64,PHN2ZyB4bWxucz0=\"))\n\n    def test_multiple_malicious_schemes(self):\n        # Test multiple malicious schemes returns True.\n        self.assertTrue(analyze_scheme(\"javascript:alert(1); vbscript:alert(2);\"))\n\n    def test_malicious_scheme_in_comment(self):\n        # Test a malicious scheme in a comment returns True.\n        self.assertTrue(analyze_scheme(\"This is dangerous: javascript:void(0);\"))\n\n    def test_case_insensitivity_safe_image(self):\n        # Test case insensitivity for safe image data URL returns False.\n        self.assertFalse(analyze_scheme(\"dAtA:iMaGe/pNg;base64,iVBORw0KGgo=\"))\n\n    def test_case_insensitivity_non_image_data(self):\n        # Test case insensitivity for non-image data URL returns True.\n        self.assertTrue(analyze_scheme(\"dAtA:text/html;base64,SGVsbG8=\"))\n\n    def test_scheme_in_word_without_colon(self):\n        # Test a scheme-like substring without colon returns False.\n        self.assertFalse(analyze_scheme(\"This contains javascript but no colon\"))\n\n    def test_colon_without_scheme(self):\n        # Test a colon without a scheme returns False.\n        self.assertFalse(analyze_scheme(\"This has a : colon but no scheme\"))\n\n    def test_malicious_scheme_case_insensitive(self):\n        # Test malicious scheme in uppercase returns True.\n        self.assertTrue(analyze_scheme(\"JAVASCRIPT:alert('XSS');\"))\n\n    def test_malicious_scheme_mixed_case(self):\n        # Test malicious scheme in mixed case returns True.\n        self.assertTrue(analyze_scheme(\"jAvAsCrIpT:alert('XSS');\"))\n\n    def test_about_scheme(self):\n        # Test 'about' scheme returns True.\n        self.assertTrue(analyze_scheme(\"about:blank\"))\n\n    def test_mocha_scheme(self):\n        # Test 'mocha' scheme returns True.\n        self.assertTrue(analyze_scheme(\"mocha:test\"))\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 25, "task_id": "f9a20828"}
{"test": "import unittest\nfrom solution import has_script_scheme\n\nclass TestCases(unittest.TestCase):\n    def test_safe_url(self):\n        # Typical safe URL without any risky schemes\n        self.assertFalse(has_script_scheme('http://example.com'))\n    \n    def test_javascript_scheme(self):\n        # URL with javascript scheme\n        self.assertTrue(has_script_scheme('javascript:alert(1)'))\n    \n    def test_vbscript_scheme(self):\n        # URL with vbscript scheme\n        self.assertTrue(has_script_scheme('vbscript:msgbox(\\'test\\')'))\n    \n    def test_data_scheme_non_image(self):\n        # Non-image data URL (should be flagged as malicious)\n        self.assertTrue(has_script_scheme('data:text/plain;base64,SGVsbG8='))\n    \n    def test_safe_image_data_url(self):\n        # Valid safe image data URL (png)\n        self.assertFalse(has_script_scheme('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=='))\n    \n    def test_unsafe_svg_image_data_url(self):\n        # SVG image data URL (unsafe)\n        self.assertTrue(has_script_scheme('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg=='))\n    \n    def test_unsafe_xml_image_data_url(self):\n        # XML image data URL (unsafe)\n        self.assertTrue(has_script_scheme('data:image/xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg=='))\n    \n    def test_image_url_without_base64(self):\n        # Image URL without base64 encoding (should be flagged as malicious)\n        self.assertTrue(has_script_scheme('data:image/png;charset=utf8,abc123'))\n    \n    def test_empty_string(self):\n        # Empty input string\n        self.assertFalse(has_script_scheme(''))\n    \n    def test_none_input(self):\n        # None input (should raise TypeError)\n        with self.assertRaises(TypeError):\n            has_script_scheme(None)\n    \n    def test_non_string_input(self):\n        # Non-string input (integer, should raise TypeError)\n        with self.assertRaises(TypeError):\n            has_script_scheme(123)\n    \n    def test_large_input(self):\n        # Very long input string without malicious schemes\n        long_str = 'http://safe.com/' + 'a' * 10000\n        self.assertFalse(has_script_scheme(long_str))\n    \n    def test_large_input_with_malicious_scheme(self):\n        # Very long input containing a malicious scheme\n        long_str = 'a' * 10000 + 'javascript:alert(1)'\n        self.assertTrue(has_script_scheme(long_str))\n    \n    def test_multiple_schemes(self):\n        # String with multiple schemes including malicious\n        self.assertTrue(has_script_scheme('data:image/png;base64,... vbscript:evil'))\n    \n    def test_case_insensitive_scheme(self):\n        # Malicious scheme with mixed case\n        self.assertTrue(has_script_scheme('jAvAsCrIpT:alert(1)'))\n    \n    def test_safe_image_with_unsafe_parameter(self):\n        # Safe image type with unsafe parameter value\n        self.assertTrue(has_script_scheme('data:image/png;type=svg;base64,abc123'))\n    \n    def test_about_scheme(self):\n        # about: scheme (considered malicious)\n        self.assertTrue(has_script_scheme('about:blank'))\n    \n    def test_mocha_scheme(self):\n        # mocha: scheme (considered malicious)\n        self.assertTrue(has_script_scheme('mocha:test'))\n    \n    def test_livescript_scheme(self):\n        # livescript: scheme (considered malicious)\n        self.assertTrue(has_script_scheme('livescript:code'))\n    \n    def test_jscript_scheme(self):\n        # jscript: scheme (considered malicious)\n        self.assertTrue(has_script_scheme('jscript:execute'))\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 20, "task_id": "aef1d2c9"}
{"test": "import unittest\nimport re\n\nclass TestCases(unittest.TestCase):\n    def test_safe_image_data_url(self):\n        # Test safe image data URL (png) returns False\n        url = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\"\n        self.assertFalse(detect_malicious_url_scheme(url))\n    \n    def test_unsafe_image_data_url_svg(self):\n        # Test unsafe image data URL (svg) returns True\n        url = \"data:image/svg;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg==\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_unsafe_image_data_url_svg_xml(self):\n        # Test unsafe image data URL (svg+xml) returns True\n        url = \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMj000MC9zdmciPjwvc3ZnPg==\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_non_image_data_url(self):\n        # Test non-image data URL returns True (due to 'data:' scheme)\n        url = \"data:text/html;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg==\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_javascript_scheme(self):\n        # Test 'javascript:' scheme returns True\n        url = \"javascript:alert('xss')\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_vbscript_scheme_in_middle(self):\n        # Test 'vbscript:' in middle returns True\n        url = \"Hello vbscript:alert('xss') world\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_mixed_case_scheme(self):\n        # Test malicious scheme with mixed case returns True\n        url = \"JAVASCRIPT:alert('xss')\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_safe_scheme_http(self):\n        # Test safe 'http' scheme returns False\n        url = \"http://example.com\"\n        self.assertFalse(detect_malicious_url_scheme(url))\n    \n    def test_no_scheme(self):\n        # Test string without scheme returns False\n        url = \"This is a test string\"\n        self.assertFalse(detect_malicious_url_scheme(url))\n    \n    def test_empty_string(self):\n        # Test empty string returns False\n        self.assertFalse(detect_malicious_url_scheme(\"\"))\n    \n    def test_none_input(self):\n        # Test None input raises TypeError\n        with self.assertRaises(TypeError):\n            detect_malicious_url_scheme(None)\n    \n    def test_non_string_input(self):\n        # Test integer input raises TypeError\n        with self.assertRaises(TypeError):\n            detect_malicious_url_scheme(123)\n    \n    def test_image_url_not_at_start(self):\n        # Test image data URL not at start returns True (due to 'data:')\n        url = \"prefix data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_image_url_without_base64(self):\n        # Test image data URL without base64 returns True (due to 'data:')\n        url = \"data:image/png,abc\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_safe_image_with_extra_text(self):\n        # Test safe image data URL with extra text returns False\n        url = \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABKdhH//2Q== extra text\"\n        self.assertFalse(detect_malicious_url_scheme(url))\n    \n    def test_unsafe_image_with_extra_text(self):\n        # Test unsafe image data URL with extra text returns True\n        url = \"data:image/svg;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg== extra text\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_about_scheme(self):\n        # Test 'about:' scheme returns True\n        url = \"about:blank\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_mocha_scheme(self):\n        # Test 'mocha:' scheme returns True\n        url = \"mocha:test\"\n        self.assertTrue(detect_malicious_url_scheme(url))\n    \n    def test_livescript_scheme(self):\n        # Test 'livescript:' scheme returns True\n        url = \"livescript:alert('test')\"\n        self.assertTrue(detect_malicious_url_scheme(url))", "num_test_cases": 19, "task_id": "e8e75a1e"}
{"test": "import unittest\n\nclass TestContainsDangerousScheme(unittest.TestCase):\n    def test_case_1(self):\n        # Test empty string\n        self.assertFalse(contains_dangerous_scheme(''))\n    \n    def test_case_2(self):\n        # Test string without any scheme\n        self.assertFalse(contains_dangerous_scheme('just a string'))\n    \n    def test_case_3(self):\n        # Test safe scheme (http)\n        self.assertFalse(contains_dangerous_scheme('http://example.com'))\n    \n    def test_case_4(self):\n        # Test dangerous scheme: javascript\n        self.assertTrue(contains_dangerous_scheme('javascript:alert(1)'))\n    \n    def test_case_5(self):\n        # Test dangerous scheme: vbscript\n        self.assertTrue(contains_dangerous_scheme('vbscript:DoSometing'))\n    \n    def test_case_6(self):\n        # Test dangerous scheme: data (non-image)\n        self.assertTrue(contains_dangerous_scheme('data:text/html;base64,ABC'))\n    \n    def test_case_7(self):\n        # Test safe image data URL (png)\n        self.assertFalse(contains_dangerous_scheme('data:image/png;base64,ABC'))\n    \n    def test_case_8(self):\n        # Test unsafe image data URL (svg)\n        self.assertTrue(contains_dangerous_scheme('data:image/svg;base64,ABC'))\n    \n    def test_case_9(self):\n        # Test unsafe image data URL (xml)\n        self.assertTrue(contains_dangerous_scheme('data:image/xml;base64,ABC'))\n    \n    def test_case_10(self):\n        # Test unsafe image data URL (svg+xml)\n        self.assertTrue(contains_dangerous_scheme('data:image/svg+xml;base64,ABC'))\n    \n    def test_case_11(self):\n        # Test safe image data URL (jpeg)\n        self.assertFalse(contains_dangerous_scheme('data:image/jpeg;base64,ABC'))\n    \n    def test_case_12(self):\n        # Test safe image data URL (gif)\n        self.assertFalse(contains_dangerous_scheme('data:image/gif;base64,ABC'))\n    \n    def test_case_13(self):\n        # Test safe image data URL (bmp)\n        self.assertFalse(contains_dangerous_scheme('data:image/bmp;base64,ABC'))\n    \n    def test_case_14(self):\n        # Test dangerous scheme in the middle of the string\n        self.assertTrue(contains_dangerous_scheme('This is a test with javascript:alert(1) in it'))\n    \n    def test_case_15(self):\n        # Test dangerous scheme at the end of the string\n        self.assertTrue(contains_dangerous_scheme('The end is javascript:alert(1)'))\n    \n    def test_case_16(self):\n        # Test safe image data URL at beginning and dangerous scheme later\n        s = 'data:image/png;base64,ABC and then javascript:alert(1)'\n        self.assertFalse(contains_dangerous_scheme(s))\n    \n    def test_case_17(self):\n        # Test dangerous scheme at beginning and safe image data URL later\n        s = 'javascript:alert(1); data:image/png;base64,ABC'\n        self.assertTrue(contains_dangerous_scheme(s))\n    \n    def test_case_18(self):\n        # Test whitespace before image data URL\n        s = ' data:image/png;base64,ABC'\n        self.assertTrue(contains_dangerous_scheme(s))\n    \n    def test_case_19(self):\n        # Test data URL that is not an image (text)\n        self.assertTrue(contains_dangerous_scheme('data:text/plain;base64,ABC'))\n    \n    def test_case_20(self):\n        # Test image data URL without base64 part\n        self.assertTrue(contains_dangerous_scheme('data:image/png,ABC'))\n", "num_test_cases": 20, "task_id": "a55fd533"}
{"test": "import unittest\nfrom unittest.mock import patch\nfrom command_module import validate_and_execute_command\n\n@patch('command_module.ALLOWED_COMMANDS', ['ls', 'echo', 'pwd'])\nclass TestCommandValidation(unittest.TestCase):\n    def test_allowed_commands(self):\n        # Test each allowed command returns itself\n        for cmd in ['ls', 'echo', 'pwd']:\n            with self.subTest(cmd=cmd):\n                result = validate_and_execute_command(cmd)\n                self.assertEqual(result, cmd)\n    \n    def test_not_allowed_command(self):\n        # Test command not in allowed list returns None\n        result = validate_and_execute_command('cat')\n        self.assertIsNone(result)\n    \n    def test_empty_string(self):\n        # Test empty string returns None\n        result = validate_and_execute_command('')\n        self.assertIsNone(result)\n    \n    def test_case_sensitivity(self):\n        # Test case sensitivity (uppercase not allowed)\n        result = validate_and_execute_command('LS')\n        self.assertIsNone(result)\n    \n    def test_non_string_input(self):\n        # Test non-string input returns None\n        result = validate_and_execute_command(123)\n        self.assertIsNone(result)\n    \n    def test_substring_of_command(self):\n        # Test substring of allowed command returns None\n        result = validate_and_execute_command('ech')\n        self.assertIsNone(result)\n    \n    def test_superset_command(self):\n        # Test command with extra characters returns None\n        result = validate_and_execute_command('echo hello')\n        self.assertIsNone(result)\n    \n    def test_long_string(self):\n        # Test very long non-allowed command returns None\n        long_str = 'a' * 1000\n        result = validate_and_execute_command(long_str)\n        self.assertIsNone(result)\n\n    def test_whitespace_command(self):\n        # Test command with leading/trailing whitespace returns None\n        result = validate_and_execute_command(' ls ')\n        self.assertIsNone(result)\n\n    def test_special_characters(self):\n        # Test command with special characters returns None\n        result = validate_and_execute_command('echo $HOME')\n        self.assertIsNone(result)\n\n    def test_null_input(self):\n        # Test None input returns None\n        result = validate_and_execute_command(None)\n        self.assertIsNone(result)", "num_test_cases": 11, "task_id": "678852a1"}
{"test": "import unittest\n\nclass TestAddCustomHeader(unittest.TestCase):\n    def test_normal_string(self):\n        # Test with normal string without special characters\n        header_value = 'HelloWorld'\n        result = add_custom_header(header_value)\n        self.assertEqual(result, 'Custom-Header: HelloWorld')\n\n    def test_newline_removal(self):\n        # Test removal of newline characters\n        header_value = 'Hello\\nWorld'\n        result = add_custom_header(header_value)\n        self.assertEqual(result, 'Custom-Header: HelloWorld')\n\n    def test_carriage_return_removal(self):\n        # Test removal of carriage return characters\n        header_value = 'Hello\\rWorld'\n        result = add_custom_header(header_value)\n        self.assertEqual(result, 'Custom-Header: HelloWorld')\n\n    def test_mixed_newline_carriage_return(self):\n        # Test removal of mixed newline and carriage return\n        header_value = 'Header\\r\\nValue\\nTest'\n        result = add_custom_header(header_value)\n        self.assertEqual(result, 'Custom-Header: HeaderValueTest')\n\n    def test_empty_string(self):\n        # Test empty header value\n        header_value = ''\n        result = add_custom_header(header_value)\n        self.assertEqual(result, 'Custom-Header: ')\n\n    def test_long_string(self):\n        # Test long string without special characters\n        header_value = 'A' * 10000\n        result = add_custom_header(header_value)\n        self.assertEqual(result, 'Custom-Header: ' + 'A'*10000)\n\n    def test_non_ascii_with_newline(self):\n        # Test non-ASCII characters with newline\n        header_value = 'H\\xe9ll\\xf6\\nW\\xf6rld'\n        result = add_custom_header(header_value)\n        self.assertEqual(result, 'Custom-Header: H\\xe9ll\\xf6W\\xf6rld')\n\n    def test_none_input(self):\n        # Test None input (invalid type)\n        with self.assertRaises(TypeError):\n            add_custom_header(None)\n\n    def test_integer_input(self):\n        # Test integer input (invalid type)\n        with self.assertRaises(TypeError):\n            add_custom_header(123)\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 9, "task_id": "105030aa"}
{"test": "import unittest\nimport html\n\n# Define the global html_template that the function uses\nhtml_template = \"<html><body>{user_content}</body></html>\"\n\nclass TestGenerateHtmlResponse(unittest.TestCase):\n    def test_normal_string(self):\n        \"\"\"Test a normal string without special characters\"\"\"\n        input_str = \"Hello, World!\"\n        expected = \"<html><body>Hello, World!</body></html>\"\n        result = generate_html_response(input_str)\n        self.assertEqual(result, expected)\n\n    def test_html_tags(self):\n        \"\"\"Test a string containing HTML tags\"\"\"\n        input_str = \"<script>alert('xss')</script>\"\n        expected = \"<html><body>&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;</body></html>\"\n        result = generate_html_response(input_str)\n        self.assertEqual(result, expected)\n\n    def test_ampersand(self):\n        \"\"\"Test a string with an ampersand\"\"\"\n        input_str = \"A & B\"\n        expected = \"<html><body>A &amp; B</body></html>\"\n        result = generate_html_response(input_str)\n        self.assertEqual(result, expected)\n\n    def test_double_quotes(self):\n        \"\"\"Test a string with double quotes\"\"\"\n        input_str = 'He said, \"Hello\"'\n        expected = \"<html><body>He said, &quot;Hello&quot;</body></html>\"\n        result = generate_html_response(input_str)\n        self.assertEqual(result, expected)\n\n    def test_single_quotes(self):\n        \"\"\"Test a string with single quotes\"\"\"\n        input_str = \"It's a beautiful day\"\n        expected = \"<html><body>It&#x27;s a beautiful day</body></html>\"\n        result = generate_html_response(input_str)\n        self.assertEqual(result, expected)\n\n    def test_empty_string(self):\n        \"\"\"Test an empty string\"\"\"\n        input_str = \"\"\n        expected = \"<html><body></body></html>\"\n        result = generate_html_response(input_str)\n        self.assertEqual(result, expected)\n\n    def test_non_string_input(self):\n        \"\"\"Test non-string input (should raise TypeError)\"\"\"\n        with self.assertRaises(TypeError):\n            generate_html_response(123)\n\n    def test_long_string(self):\n        \"\"\"Test a very long string\"\"\"\n        input_str = \"A\" * 10000\n        expected = f\"<html><body>{input_str}</body></html>\"\n        result = generate_html_response(input_str)\n        self.assertEqual(result, expected)\n\n    def test_special_characters(self):\n        \"\"\"Test a string with multiple special characters\"\"\"\n        input_str = '<>&\"\\''\n        expected = \"<html><body>&lt;&gt;&amp;&quot;&#x27;</body></html>\"\n        result = generate_html_response(input_str)\n        self.assertEqual(result, expected)\n\nif __name__ == '__main__':\n    unittest.main()", "num_test_cases": 9, "task_id": "1ab76d35"}
